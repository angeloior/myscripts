az login -u angelo.iorli@ptvgroup.com -p <password>

#update x 15
#5 windows 3389
az network nsg rule update -g Optima-Training1 --nsg-name ptv-optima-dot1-nsg -n default-allow-rdp --source-address-prefix '195.94.174.138'
az network nsg rule update -g Optima-Training2 --nsg-name ptv-optima-dot2-nsg -n default-allow-rdp --source-address-prefix '195.94.174.138'
az network nsg rule update -g Optima-Training3 --nsg-name ptv-optima-dot3-nsg -n default-allow-rdp --source-address-prefix '195.94.174.138'
az network nsg rule update -g Optima-Training4 --nsg-name ptv-optima-dot4-nsg -n default-allow-rdp --source-address-prefix '195.94.174.138'
az network nsg rule update -g Optima-Training5 --nsg-name ptv-optima-dot5-nsg -n default-allow-rdp --source-address-prefix '195.94.174.138'

#10 linux 22
#as
az network nsg rule update -g Optima-Training1 --nsg-name ptv-optima-as1-nsg -n default-allow-ssh --source-address-prefix '195.94.174.138'
az network nsg rule update -g Optima-Training2 --nsg-name ptv-optima-as2-nsg -n default-allow-ssh --source-address-prefix '195.94.174.138'
az network nsg rule update -g Optima-Training3 --nsg-name ptv-optima-as3-nsg -n default-allow-ssh --source-address-prefix '195.94.174.138'
az network nsg rule update -g Optima-Training4 --nsg-name ptv-optima-as4-nsg -n default-allow-ssh --source-address-prefix '195.94.174.138'
az network nsg rule update -g Optima-Training5 --nsg-name ptv-optima-as5-nsg -n default-allow-ssh --source-address-prefix '195.94.174.138'

#db
az network nsg rule update -g Optima-Training1 --nsg-name ptv-optima-db1-nsg -n default-allow-ssh --source-address-prefix '195.94.174.138'
az network nsg rule update -g Optima-Training2 --nsg-name ptv-optima-db2-nsg -n default-allow-ssh --source-address-prefix '195.94.174.138'
az network nsg rule update -g Optima-Training3 --nsg-name ptv-optima-db3-nsg -n default-allow-ssh --source-address-prefix '195.94.174.138'
az network nsg rule update -g Optima-Training4 --nsg-name ptv-optima-db4-nsg -n default-allow-ssh --source-address-prefix '195.94.174.138'
az network nsg rule update -g Optima-Training5 --nsg-name ptv-optima-db5-nsg -n default-allow-ssh --source-address-prefix '195.94.174.138'


#create 5 per linux 5432
az network nsg rule create -g Optima-Training1 --nsg-name ptv-optima-db1-nsg -n Port-5432 --priority 1010 --source-address-prefixes 195.94.174.138 --destination-address-prefixes '*' --destination-port-ranges 5432 --access Allow --protocol Tcp --description "Allow from Sistema access to postgresql port 5432"
az network nsg rule create -g Optima-Training2 --nsg-name ptv-optima-db2-nsg -n Port-5432 --priority 1010 --source-address-prefixes 195.94.174.138 --destination-address-prefixes '*' --destination-port-ranges 5432 --access Allow --protocol Tcp --description "Allow from Sistema access to postgresql port 5432"
az network nsg rule create -g Optima-Training3 --nsg-name ptv-optima-db3-nsg -n Port-5432 --priority 1010 --source-address-prefixes 195.94.174.138 --destination-address-prefixes '*' --destination-port-ranges 5432 --access Allow --protocol Tcp --description "Allow from Sistema access to postgresql port 5432"
az network nsg rule create -g Optima-Training4 --nsg-name ptv-optima-db4-nsg -n Port-5432 --priority 1010 --source-address-prefixes 195.94.174.138 --destination-address-prefixes '*' --destination-port-ranges 5432 --access Allow --protocol Tcp --description "Allow from Sistema access to postgresql port 5432"
az network nsg rule create -g Optima-Training5 --nsg-name ptv-optima-db5-nsg -n Port-5432 --priority 1010 --source-address-prefixes 195.94.174.138 --destination-address-prefixes '*' --destination-port-ranges 5432 --access Allow --protocol Tcp --description "Allow from Sistema access to postgresql port 5432"

#configure dns name x15
#5 windows
az network public-ip update -g Optima-Training1 -n ptv-optima-dot1-ip --dns-name optima-training1-dot
az network public-ip update -g Optima-Training2 -n ptv-optima-dot2-ip --dns-name optima-training2-dot
az network public-ip update -g Optima-Training3 -n ptv-optima-dot3-ip --dns-name optima-training3-dot
az network public-ip update -g Optima-Training4 -n ptv-optima-dot4-ip --dns-name optima-training4-dot
az network public-ip update -g Optima-Training5 -n ptv-optima-dot5-ip --dns-name optima-training5-dot

#5 linux as
az network public-ip update -g Optima-Training1 -n ptv-optima-as1-ip --dns-name optima-training1-as
az network public-ip update -g Optima-Training2 -n ptv-optima-as2-ip --dns-name optima-training2-as
az network public-ip update -g Optima-Training3 -n ptv-optima-as3-ip --dns-name optima-training3-as
az network public-ip update -g Optima-Training4 -n ptv-optima-as4-ip --dns-name optima-training4-as
az network public-ip update -g Optima-Training5 -n ptv-optima-as5-ip --dns-name optima-training5-as

#5 linux db
az network public-ip update -g Optima-Training1 -n ptv-optima-db1-ip --dns-name optima-training1-db
az network public-ip update -g Optima-Training2 -n ptv-optima-db2-ip --dns-name optima-training2-db
az network public-ip update -g Optima-Training3 -n ptv-optima-db3-ip --dns-name optima-training3-db
az network public-ip update -g Optima-Training4 -n ptv-optima-db4-ip --dns-name optima-training4-db
az network public-ip update -g Optima-Training5 -n ptv-optima-db5-ip --dns-name optima-training5-db